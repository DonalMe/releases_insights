{% extends 'base.html.twig' %}

{% block header %}
  <header class="mx-auto">
    <h1>
      <a href="?version={{ release -1 }}" title="Previous release" alt="Go to previous release">«</a>
      &nbsp;Firefox&nbsp;{{ release }}&nbsp;
      {% if release != constant('FIREFOX_RELEASE') %}<a href="?version={{ release +1 }}" title="Next release"  alt="Go to next release">»</a><br><a href="?version={{ constant('FIREFOX_RELEASE')|number_format }}" class="btn btn-primary">Go to Release channel</a>{% endif %}
    </h1>
  </header>
{% endblock %}

{% block main %}
{% if not fallback_content %}
  {% if  release == constant('FIREFOX_RELEASE')|number_format + 1  %}
    {% set alert = 'Version currently on the <b class="text-danger">Beta</b> channel.' %}
    {% set channel = 'beta' %}

  {% elseif  release == constant('FIREFOX_RELEASE')|number_format + 2 %}
    {% set alert = 'Version currently available on the <b class="text-danger">Nightly</b> channel.' %}
    {% set channel = 'nightly' %}
  {% else %}
    {% set alert = 'Future version, development not started yet.' %}
    {% set channel = 'future' %}
  {% endif %}

  <div class="w-25 alert alert-primary mx-auto text-center" role="alert">{{ alert|raw }}</div>

  <table class="table table-striped table-bordered table-sm w-25 justify-content-center">
    <tr>
      <th class="w-50">Release Date</th><td>{{ release_date|format_date('long', locale='en') }}</td>
    </tr>
    <tr>
      <th class="w-50">Release Owner</th><td>{{ release_owner }}</td>
    </tr>
    <tr>
      <th>Beta cycle length</th><td>{{ beta_cycle_length|number_format }} weeks</td>
    </tr>
    <tr>
      <th>Nightly cycle length</th><td>{{ nightly_cycle_length|number_format }} weeks</td>
    </tr>

    {% if channel == 'beta' %}
    <tr>
      <th>Current Beta</th><td>{{ constant('FIREFOX_BETA') }}</td>
    </tr>
    {% endif %}
  </table>

  <table class="table table-striped table-bordered table-sm w-25 justify-content-center mt-4">
  <caption class="alert-success mx-auto text-center" style="caption-side:top">Milestones</caption>
    <tr {{ date(cycle_dates.nightly_start) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.nightly_start) < date() ? ' class="text-muted font-weight-light"' }}>Nightly start</th>
      <td class="text-right">{{ cycle_dates.nightly_start|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.soft_code_freeze) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.soft_code_freeze) < date() ? ' class="text-muted font-weight-light"' }}>Soft Code Freeze starts</th>
      <td class="text-right">{{ cycle_dates.soft_code_freeze|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.string_freeze) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.string_freeze) < date() ? ' class="text-muted font-weight-light"' }}>String Freeze starts</th>
      <td class="text-right">{{ cycle_dates.string_freeze|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.merge_day) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.merge_day) < date() ? ' class="text-muted font-weight-light"' }}>Merge day</th>
      <td class="text-right">{{ cycle_dates.merge_day|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.beta_1) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.beta_1) < date() ? ' class="text-muted font-weight-light"' }}>Beta 1</th>
      <td class="text-right">{{ cycle_dates.beta_1|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.beta_2) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.beta_2) < date() ? ' class="text-muted font-weight-light"' }}>Beta 2</th>
      <td class="text-right">{{ cycle_dates.beta_2|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.beta_3) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.beta_3) < date() ? ' class="text-muted font-weight-light"' }}>Beta 3</th>
      <td class="text-right">{{ cycle_dates.beta_3|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.beta_4) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.beta_4) < date() ? ' class="text-muted font-weight-light"' }}>Beta 4</th>
      <td class="text-right">{{ cycle_dates.beta_4|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.beta_5) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.beta_5) < date() ? ' class="text-muted font-weight-light"' }}>Beta 5</th>
      <td class="text-right">{{ cycle_dates.beta_5|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.beta_6) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.beta_6) < date() ? ' class="text-muted font-weight-light"' }}>Beta 6 <small class="font-weight-light">early betas end</small></th>
      <td class="text-right">{{ cycle_dates.beta_6|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.beta_7) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.beta_7) < date() ? ' class="text-muted font-weight-light"' }}>Beta 7</th>
      <td class="text-right">{{ cycle_dates.beta_7|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.beta_8) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.beta_8) < date() ? ' class="text-muted font-weight-light"' }}>Beta 8</th>
      <td class="text-right">{{ cycle_dates.beta_8|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.beta_9) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.beta_9) < date() ? ' class="text-muted font-weight-light"' }}>Beta 9 <small class="font-weight-light">last beta uplifts</small></th>
      <td class="text-right">{{ cycle_dates.beta_9|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.rc_gtb) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.rc_gtb) < date() ? ' class="text-muted font-weight-light"' }}>Go to Build Release Candidate</th>
      <td class="text-right">{{ cycle_dates.rc_gtb|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.rc) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.rc) < date() ? ' class="text-muted font-weight-light"' }}>RC</th>
      <td class="text-right">{{ cycle_dates.rc|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
    <tr {{ date(cycle_dates.release) < date() ? ' class="text-muted font-weight-light"' }}>
      <th {{ date(cycle_dates.release) < date() ? ' class="text-muted font-weight-light"' }}>Release day!</th>
      <td class="text-right"  >{{ cycle_dates.release|format_date(pattern='MMMM d', locale='en') }}</td>
    </tr>
  </table>

{% endif %}
  {{ fallback_content|raw }}

{% endblock %}

{% block footer %}
  <footer></footer>
{% endblock %}
